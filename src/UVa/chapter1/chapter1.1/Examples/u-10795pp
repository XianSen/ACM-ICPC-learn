#include <stdio.h>
#include <stdlib.h>
#include <string.h>

const int maxn = 61;
typedef unsigned long long ull;

int start[maxn];
int end[maxn];

ull power(int i){
    ull u = 1;
    return (u << i);
}

ull f(int *p, int i, int final){
    if(i == 0) return 0;
    if(final == p[i]) return f(p, i-1, final);
    else return (f(p, i - 1, 6 - p[i] - final) + power(i-1));
}

int main(){
    int n, k, cas = 0;
    while(scanf("%d", &n) != EOF){
	if(n == 0) break;
	for(int i = 1; i <= n; i++)
	    scanf("%d", start + i);
	for(int i = 1; i <= n; i++)
	    scanf("%d", end + i);
	k = n;
	while(k >= 1 && start[k] == end[k])
	    k--;

	ull ans = 0;
	if(k >= 1){
	    //printf("are you ok");
	    int other = 6 - start[k] - end[k];
	    ans = f(start, k - 1, other) + f(end, k - 1, other) + 1;
	}

	printf("Case %d: %lld\n",++cas, ans);
    }
    return 0;
}
